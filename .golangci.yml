version: "2"

linters:
  enable:
    - asasalint # checks for pass []any as any in variadic func(...any)
    - asciicheck # checks that your code does not contain non-ASCII identifiers
    - bidichk # checks for dangerous unicode character sequences
    - bodyclose # checks whether HTTP response body is closed successfully
    - canonicalheader # checks whether net/http.Header uses canonical header
    - containedctx # detects struct contained context.Context field
    - contextcheck # checks the function whether use a non-inherited context
    - copyloopvar # detects places where loop variables are copied
    - dogsled # checks assignments with too many blank identifiers (e.g. x, _, _, _, := f())
    - dupl # detects duplicate fragments of code
    - dupword # checks for duplicate words in the source code
    - durationcheck # checks for two durations multiplied together
    - embeddedstructfieldcheck # checks embedded types in structs
    - errcheck # checking for unchecked errors
    - errname # checks that sentinel errors are prefixed with the Err and error types are suffixed with the Error
    - errorlint # finds code that will cause problems with the error wrapping scheme introduced in Go 1.13
    - exhaustive # checks exhaustiveness of enum switch statements
    - exhaustruct # checks if all structure fields are initialized
    - exptostd # detects functions from golang.org/x/exp/ that can be replaced by std functions
    - fatcontext # detects nested contexts in loops
    - forbidigo # forbids identifiers (Print functions by default)
    - funcorder # checks the order of functions, methods, and constructors
    - funlen # checks for long functions
    - gocheckcompilerdirectives # checks that go compiler directive comments (//go:) are valid
    - gochecknoglobals # checks that no global variables exist
    - gochecknoinits # checks that no init functions are present in Go code
    - gochecksumtype # checks exhaustiveness on Go "sum types"
    - gocognit # computes and checks the cognitive complexity of functions
    - goconst # finds repeated strings that could be replaced by a constant
    - gocritic # provides diagnostics that check for bugs, performance and style issues
    - gocyclo # computes and checks the cyclomatic complexity of functions
    - godox # detects usage of FIXME, TODO and other keywords inside comments
    - gosec # inspects source code for security problems
    - govet # reports suspicious constructs, such as Printf calls whose arguments do not align with the format string
    - iface # checks the incorrect use of interfaces, helping developers avoid interface pollution
    - ineffassign # detects when assignments to existing variables are not used
    - interfacebloat # checks the number of methods inside an interface
    - intrange # finds places where for loops could make use of an integer range
  
  settings:
    errcheck:
      check-type-assertions: true
      check-blank: true
    
    copyloopvar:
      check-alias: true

    embeddedstructfieldcheck:
      forbid-mutex: true

    exhaustive:
      check:
        - switch
        - map

    exhaustruct:
      exclude:
        - ^net/http.Response$
        - ^net/http.Server$
        - ^github.com/marchuknikolay/rss-parser/internal/model.Channel$
        - ^github.com/marchuknikolay/rss-parser/internal/storage.Storage$

    gocognit:
      min-complexity: 20

    goconst:
      min-len: 2
      min-occurrences: 2
      numbers: true
      find-duplicates: true

    gocritic:
      enable-all: true
      disabled-checks:
        - whyNoLint
      settings:
        nestingReduce:
          bodyWidth: 4
        rangeValCopy:
          sizeThreshold: 80
        tooManyResultsChecker:
          maxResults: 2

    gocyclo:
      min-complexity: 10

    govet:
      enable-all: true

    iface:
      enable:
        - identical
        - unused
        - opaque
        - unexported

    interfacebloat:
      max: 6

  exclusions:
    rules:
      - path: '_test.go'
        linters:
          - dupl
          - exhaustruct
          - gochecknoglobals

      - source: '^func Test'
        linters:
          - funlen

      - path: 'internal/server/handlers/items.go'
        linters:
          - gosec
        text: 'G203'

      - path: 'internal/model/model.go'
        linters:
          - govet
        text: 'fieldalignment'